rules:
  - id: java-sqli-string-concat
    languages: [java]
    message: "Possible SQL injection: concatenated SQL passed to executeQuery()/executeUpdate(). Use PreparedStatement."
    severity: ERROR
    pattern: $ST.executeQuery($SQL)
    pattern-inside: |
      $SQL = $A + $B

  - id: java-sqli-exec-with-plus
    languages: [java]
    message: "Possible SQL injection: execute(...) called with string concatenation expression."
    severity: ERROR
    pattern-regex: 'execute(Query|Update)?\s*\(\s*.*\+.*\)'

  - id: java-sqli-stringbuilder
    languages: [java]
    message: "Possible SQL injection: SQL assembled with StringBuilder then executed. Prefer parameterized queries."
    severity: ERROR
    patterns:
      - pattern: StringBuilder $SB = new StringBuilder()
      - pattern-either:
          - pattern: $SB.append($X)
      - pattern: $ST.executeQuery($SB.toString())
