rules:
  - id: java-sql-injection-statement
    languages: [java]
    message: "Possible SQL injection when using Statement + execute with dynamic SQL. Use PreparedStatement with parameter binding."
    severity: ERROR
    metadata:
      cwe: "CWE-89"
      owasp: "Injection"
    pattern-either:
      - patterns:
          - pattern-inside: |
              Statement $S = $CONN.createStatement();
              ...
          - pattern-either:
              - pattern: $S.execute($SQL)
              - pattern: $S.executeQuery($SQL)
              - pattern: $S.executeUpdate($SQL)
      - patterns:
          - pattern-inside: |
              $S = $CONN.createStatement();
              ...
          - pattern-either:
              - pattern: $S.execute($SQL)
              - pattern: $S.executeQuery($SQL)
              - pattern: $S.executeUpdate($SQL)